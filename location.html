<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<link rel="shortcut icon" href="assets/img/favicon.png" type="image/x-icon">
<title>Brownie üêà‚Äç‚¨õ</title>

<!-- SDK EmailJS -->
<script src="https://cdn.jsdelivr.net/npm/emailjs-com@3/dist/email.min.js"></script>

<style>
:root{
    --primary:#1f7bd6;
    --primary-light:#3aa0ff;
    --bg:#f4f7fb;
    --text:#233142;
    --muted:#6b7b8c;
    --border:#e6ecf2;
}
*{ box-sizing:border-box; }
body{
    margin:0;
    font-family: system-ui, -apple-system, 'Segoe UI', Roboto, Arial, sans-serif;
    background: var(--bg);
    display:flex;
    justify-content:center;
    align-items:center;
    min-height:100vh;
}
.container{
    width:100%;
    max-width:650px;
    background:#ffffff;
    border-radius:12px;
    box-shadow:0 10px 30px rgba(0,0,0,0.08);
    overflow:hidden;
    border:1px solid var(--border);
}
.header{
    background: linear-gradient(90deg,var(--primary),var(--primary-light));
    color:white;
    padding:24px;
}
.header h1{
    margin:0;
    font-size:20px;
    font-weight:600;
}
.content{
    padding:24px;
    color:var(--text);
}
.label{
    font-size:13px;
    color:var(--muted);
    margin-bottom:6px;
}
.location-box{
    margin-top:10px;
    padding:18px;
    background:#eef7ff;
    border-radius:10px;
    border:1px solid #dbeafe;
    font-weight:500;
}
#Pos{
    font-weight:600;
    font-size:15px;
}
#PosLink a{
    display:inline-block;
    margin-top:10px;
    text-decoration:none;
    color:var(--primary);
    font-weight:500;
}
#PosLink a:hover{
    text-decoration:underline;
}
button{
    margin-top:20px;
    width: 35%;
    padding:12px;
    border:none;
    border-radius:8px;
    background:var(--primary);
    color:white;
    font-size:15px;
    font-weight:600;
    cursor:pointer;
    transition: all 0.25s ease;
}
button:hover{
    background:#1665b5;
    transform: translateY(-2px);
    box-shadow:0 6px 14px rgba(31,123,214,0.3);
}
button:active{
    transform: translateY(0);
    box-shadow:none;
}
.footer{
    padding:14px 24px;
    background:#fafbfd;
    border-top:1px solid var(--border);
    font-size:12px;
    color:var(--muted);
    text-align:center;
}
@media(max-width:600px){
    .content{ padding:18px; }
    .header{ padding:18px; }
}
</style>

<script>
window.addEventListener('load', function(){

    emailjs.init("wL0I2WymHVertsbw-"); // üîπ TU PUBLIC KEY

    const posElt = document.getElementById('Pos');
    const posLinkElt = document.querySelector('#PosLink > a');
    const sendBtn = document.getElementById('sendMail');

    navigator.geolocation.getCurrentPosition(geoposOK, geoposKO);

    function geoposOK(pos){

        const lat = pos.coords.latitude;
        const long = pos.coords.longitude;
        const mapUrl = `https://maps.google.com/?q=${lat},${long}`;

        posElt.textContent = `${lat}, ${long}`;
        posLinkElt.href = mapUrl;
        posLinkElt.textContent = "Mostrar tu posici√≥n en un mapa";

        sendBtn.addEventListener('click', function(){

            // üìÖ Hora exacta del escaneo
            const now = new Date();
            const time = now.toLocaleString("es-AR", {
                timeZone: "America/Argentina/Buenos_Aires",
                year: "numeric",
                month: "2-digit",
                day: "2-digit",
                hour: "2-digit",
                minute: "2-digit",
                second: "2-digit"
            });

            const templateParams = {
                lat: lat,
                long: long,
                map_url: mapUrl,
                time: time,
                namePet: "Brownie",
                to_email: "maumontoya99@gmail.com"
            };

            emailjs.send("service_vndscod", "template_tco7pdf", templateParams) // üîπ SERVICE ID, TEMPLATE ID
            .then(function(response) {
                window.location.href = "index.html";
                console.log("SUCCESS!", response.status, response.text);
            }, function(error) {
                alert("Error al enviar ‚ùå");
                console.log("FAILED...", error);
            });

        });
    }

    function geoposKO(err){
        posElt.textContent = "Error obteniendo ubicaci√≥n: " + err.message;
    }

});
</script>
</head>

<body>

<div class="container">

    <div class="header">
        <h1>üìç ¬øTe importar√≠a compartir d√≥nde has escaneado este c√≥digo QR?</h1>
    </div>

    <div class="content">
        <div class="label">Tu posici√≥n actual</div>

        <div class="location-box">
            <span id="Pos">Obteniendo ubicaci√≥n...</span>
            <p id="PosLink"><a target="_blank"></a></p>
        </div>

        <button id="sendMail">S√≠, adelante.</button>

        <a href="index.html"> 
            <button style="background:#d7dde4;color:rgb(107,103,103);">
                No, gracias.
            </button>
        </a>
        
    </div>

    <div class="footer">
        Sistema de geolocalizaci√≥n autom√°tica
    </div>

</div>
</body>
</html>
